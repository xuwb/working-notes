"use strict";define(function(require,exports,module){function e(e,n,t,o,a){return a=a||{},void 0===a.needPop&&(a.needPop=!0),a.needPop&&r.show(a),$.ajax({url:e,dataType:"json",type:t,data:n,timeout:1e5,cache:!1,success:function(e){a.needPop&&r.hide(),o(e)},error:function(e){a.needPop&&r.hide()}})}function n(e,n,t,o,a){return"function"==typeof n?(o=c(n),n={},t="post"):"function"==typeof t?(o=c(t),t="post"):o=c(o),[e,n,t,o,a]}var $=require("$"),t=require("common/util"),o=require("common/limit2.0"),a=require("common/handlerbars"),r=require("model/poploading/main"),i={},c=t.maybeCallback,u=/^(.+)\.(.+)/,d=t.K;i.isWebkit=!!navigator.vendor,i.util=t,i.jQuery=$,i.handlerbars=a,i.closest=function(e,n){return $(e).closest(n)},i.show=function(e){$(e).removeClass("fn-hide")},i.hide=function(e){$(e).addClass("fn-hide")},i.redraw=function(e){i.hide(e),setTimeout(function(){i.show(e)},0)},i.disabledTrue=function(e){var n=$(e).find("input,select,textarea,button");n.prop("disabled",!0)},i.disabledFalse=function(e){var n=$(e).find("input,select,textarea,button");n.prop("disabled",!1)},i.getInputValue=function(e,n){return e.find('[name="'+n+'"]').val()},i.getEscapeUrl=function(e){return encodeURIComponent(e)},i.resetForm=function(e){var n=$(e)[0];n&&n.reset&&n.reset(),t.breakEachArr(n,function(e){if("hidden"===e.type){var n=$(e).data("defaultValue");void 0!==n&&(e.value=n)}})},i.redirect=function(e){location.href=e},i.paseParam=function(e,n,t){var o={};return t=t||d,o[e]=JSON.stringify(t(n)),o},i.ajax=function(t,o,a,r,i){var c=n(t,o,a,r,i),u=c[3];c[3]=function(e){e.hasError?u(e.errors&&e.errors[0]&&e.errors[0].msg||"ajax请求，系统异常！",e.errors):u(null,e.content)},e.apply(null,c)},i.http=function(t,o,a,r,i){var c=n(t,o,a,r,i),u=c[3];c[3]=function(e){var n;e.hasError?u(e.errors&&e.errors[0]&&e.errors[0].msg||"ajax请求，系统异常！",e.errors):(n=e.content,n.isSuccess?u(null,n.retValue,n.message,n):u(n.message,n))},e.apply(null,c)},i.unSerialize=function(e,n,a){var r,i,c,u=0;for(a=a||t.K,n=a(n),"FORM"!==e.nodeName&&(e=$(e).find("input,select,textarea,button"));c=e[u++];)(r=c.name)&&(i=n[r])&&("checkbox"===c.type?o.contains(i.split(","),c.value)?c.checked=!0:c.checked=!1:"radio"===c.type?c.value===i?c.checked=!0:c.checked=!1:c.value=c.defaultValue=i)};var l=i.serialize=function(e,n){e=$(e);var a,r,i,c,d=0,s=[],f={};for(n=n||t.K,i=e.find("[data-serialize-name]"),c=e.find(".JS-serialize-exclude"),e=e.find("input,select,textarea,button").not(c.find("input,select,textarea,button")).not(i.find("input,select,textarea,button"));a=e[d];d++)if((r=a.name)&&a.disabled===!1){switch(a.type){case"radio":if(!a.checked)continue;break;case"checkbox":a.checked&&(f[r]||(f[r]=[],s.push(r)),f[r].push($.trim(a.value)));continue}f[r]=$.trim(e.eq(d).val())}return t.breakEachArr(s,function(e){f[e]=f[e].join(",")}),t.breakEachObj(f,function(e,n,t){if(u.test(n)){var o=t[RegExp.$1]||(t[RegExp.$1]={});o[RegExp.$2]=e,delete t[n]}}),i.each(function(){var e,n,t=$(this),a=t.data("serializeName");(e=f[a])||(e=f[a]=[]),n=l(t),!o.isEmpty(n)&&e.push(n)}),n(f)};return i.selectSerialize=function(e,n){e.length=0,t.breakEachArr(n,function(n,t){var o=new Option(n.key,n.value,!!n.selected,!!n.selected);o.disabled=!!n.disabled,e.add(o)})},i.onChange=function(e,n){function t(){var t=e.val();t!==o&&n.call(e,t,o),o=t}e=$(e);var o=e.val();e.on("input.eventChange",t),9===document.documentMode&&e.on("keyup.eventChange",function(e){8===e.keyCode&&t()}),8===document.documentMode&&e.on("propertychange.eventChange",function(e){"value"===e.originalEvent.propertyName&&t()})},i.offChange=function(e){e=$(e),e.off("input.eventChange").off("keyup.eventChange").off("propertychange.eventChange")},i.winScrollY=function(e){return 0===arguments.length?window.scrollY||document.documentElement.scrollTop:(document.documentElement.scrollTop=e,void window.scrollTo(0,e))},i.winInnerHeight=function(){return window.innerHeight||document.documentElement.clientHeight},i});