"use strict";define(function(require,exports,module){var e=require("common/myWidget"),t=require("model/modal/main"),r=e.extend({clssName:"Ajax",attrs:{request:"",paramName:null,autoDestroy:!0,autoErrorAlert:!0,autoSuccessAlert:!1,autoSubmit:!1,method:"http",type:"post",param:{},paramParse:e.K,parseForm:"",needText:!1,needPop:!0},events:{},initProps:function(){},setup:function(){var e=this;e.get("autoSubmit")&&e.submit()},serializeForm:function(){var e=this,t=e.get("param"),r=[e.element].concat(e.get("parseForm"));return e.breakEachArr(r,function(r){r=$(r),r.length&&$.extend(t,e.serialize(r))}),e.get("paramParse")(t)},submit:function(){var e=this,r=e.get("paramName"),a=e.serializeForm(),n=r?e.paseParam(r,a):a;return e.trigger("ajaxSubmitBefore",a)&&e[e.get("method")](e.get("request"),n,e.get("type"),function(r,n,s,o){var u=e.setArray(arguments);u.push(a),r?(e.get("autoErrorAlert")&&t.alert(0,r),u.unshift("ajaxError"),e.trigger.apply(e,u)):(e.get("autoSuccessAlert")&&t.alert(1,s),u.shift(),u.unshift("ajaxSuccess"),e.trigger.apply(e,u)),e.get("autoDestroy")&&e.destroy()},{needText:e.get("needText"),needPop:e.get("needPop")}),e},Statics:{when:function(){var e=this,t=[];return e.breakEachArr(arguments,function(e){var a=$.Deferred();new r(e).on("ajaxSuccess",function(e,t,r){a.resolve({val:e,msg:t,res:r})}).on("ajaxError",function(e){a.reject({err:e})}).submit(),t.push(a)}),$.when.apply($,t)}}});return r});