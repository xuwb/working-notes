"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();define(function(require,exports,module){var t=require("react"),e=require("common/validator"),n=require("common/limit2.0"),o=(require("common/domUtil"),require("model/ajax/main")),r=function(r){function a(){var t,e,n,o;_classCallCheck(this,a);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return e=n=_possibleConstructorReturn(this,(t=Object.getPrototypeOf(a)).call.apply(t,[this].concat(i))),n.state={isExecute:!1,isSubmit:!1},o=e,_possibleConstructorReturn(n,o)}return _inherits(a,r),_createClass(a,[{key:"clearAttr",value:function(){var t=this,e=t.props;return n.compose(function(t){return n.each(t.__specalAttr,function(e){delete t[e]}),delete t.__specalAttr,t},function(t){return n.assign({},t)})(e)}},{key:"submit",value:function(){var t=this,e=t.state;e.isSubmit=!0}},{key:"initValidator",value:function(){var t=this,o=t.state,r=t.props;t.validatorExp&&t.validatorExp.destroy(),t.validatorExp=e.use(t.refs.form,'[data-need="validator"]',{autoSubmit:!1}),t.validatorExp.on("formValidated",function(e,a){o.isExecute=!0,e?n["!!!"](n.filter(a,function(t){return t[0]})):o.isSubmit&&(r.onSubmit(),t.initAjax())}),o.isExecute&&t.validatorExp.execute()}},{key:"initAjax",value:function(){var t=this,e=t.props;new o(n.assign({request:e.action,parseForm:t.refs.form,paramName:e.paramName},e.ajaxConfig)).on("ajaxSuccess",e.onAjax).submit()}},{key:"componentDidUpdate",value:function(){var t=this,e=t.state;e.isSubmit=!1,t.validatorExp.destroy(),t.initValidator()}},{key:"componentDidMount",value:function(){var t=this,e=t.props;t.initValidator(),e.isAutoAjax&&t.initAjax()}},{key:"componentWillUnmount",value:function(){var t=this;t.validatorExp.destroy()}},{key:"render",value:function(){var e=this,n=e.clearAttr();return console.log(n),t.createElement("form",_extends({},n,{ref:"form",onSubmit:e.submit.bind(e)}),n.children)}}]),a}(t.Component);return r.defaultProps={onSubmit:n.K,onAjax:n.K,isAutoAjax:!1,ajaxConfig:{},__specalAttr:["onSubmit","onAjax","isAutoAjax","ajaxConfig"],action:"./data.json"},r});